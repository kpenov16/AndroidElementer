package lekt05_grafik;

import androidx.appcompat.app.AppCompatActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.animation.AlphaAnimation;
import android.view.animation.Animation;
import android.view.animation.Animation.AnimationListener;
import android.view.animation.AnimationSet;
import android.view.animation.AnimationUtils;
import android.view.animation.BounceInterpolator;
import android.view.animation.DecelerateInterpolator;
import android.view.animation.RotateAnimation;
import android.view.animation.ScaleAnimation;
import android.view.animation.TranslateAnimation;
import android.widget.Button;
import android.widget.ScrollView;
import android.widget.TableLayout;

import dk.nordfalk.android.elementer.R;

/**
 * @author Jacob Nordfalk
 */
public class BenytAnimationer extends AppCompatActivity implements OnClickListener {

  Button knap1, knap2, knap3, knap4, knap5, knap6, knap7;
  private int animIndeks;

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    TableLayout tl = new TableLayout(this);

    knap1 = new Button(this);
    knap1.setText("AnimationUtils.makeOutAnimation(this, true)");
    tl.addView(knap1);

    knap2 = new Button(this);
    knap2.setText("InAnimation(this, true)\nOutAnimation(this, false)");
    tl.addView(knap2);

    knap3 = new Button(this);
    knap3.setText("Hægte to animationer sammen der 'vender et kort'");
    tl.addView(knap3);

    knap4 = new Button(this);
    knap4.setText("Programmatiske animationer");
    tl.addView(knap4);

    knap5 = new Button(this);
    knap5.setText("Animeret skift af aktivitet");
    tl.addView(knap5);

    knap6 = new Button(this);
    knap6.setText("Eksempler på animationer");
    tl.addView(knap6);

    knap7 = new Button(this);
    knap7.setText("Pyjamasdans!");
    tl.addView(knap7);

    if (savedInstanceState == null) {
      knap1.startAnimation(AnimationUtils.makeInAnimation(this, true));
      knap2.startAnimation(AnimationUtils.makeInAnimation(this, false));
    }

    knap1.setOnClickListener(this);
    knap2.setOnClickListener(this);
    knap3.setOnClickListener(this);
    knap4.setOnClickListener(this);
    knap5.setOnClickListener(this);
    knap6.setOnClickListener(this);
    knap7.setOnClickListener(this);

    ScrollView sv = new ScrollView(this);
    sv.addView(tl);
    setContentView(sv);
  }

  public void onClick(View klikPåHvad) {
    if (klikPåHvad == knap1) {
      Animation animation = AnimationUtils.makeOutAnimation(this, true);
      knap1.startAnimation(animation);
    } else if (klikPåHvad == knap2) {
      knap1.startAnimation(AnimationUtils.makeInAnimation(this, true));
      knap2.startAnimation(AnimationUtils.makeOutAnimation(this, false));
    } else if (klikPåHvad == knap3) {
      // Se også http://developer.android.com/training/animation/cardflip.html
      Animation vende1 = AnimationUtils.loadAnimation(this, R.anim.vende1);
      final Animation vende2 = AnimationUtils.loadAnimation(this, R.anim.vende2);
      vende1.setAnimationListener(new AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {
        }

        @Override
        public void onAnimationEnd(Animation animation) {
          knap1.setText("Her er bagsiden");
          knap1.startAnimation(vende2);
        }

        @Override
        public void onAnimationRepeat(Animation animation) {
        }
      });
      knap1.setText("FORSIDE");
      knap1.startAnimation(vende1);
    } else if (klikPåHvad == knap4) {
      TranslateAnimation translationsanim = new TranslateAnimation(-100.0f, 0, 0, 0);
      translationsanim.setDuration(5000); // 5 sekunder
      translationsanim.setInterpolator(new BounceInterpolator());
      knap2.startAnimation(translationsanim);

      AlphaAnimation alfaanim = new AlphaAnimation(0.0f, 1.0f);
      alfaanim.setDuration(200);
      alfaanim.setRepeatCount(4); //evt Animation.INFINITE);
      alfaanim.setRepeatMode(Animation.REVERSE);
      knap3.startAnimation(alfaanim);

      ScaleAnimation skalaanim = new ScaleAnimation(1, 0.7f, 1, 1.5f, knap4.getWidth() / 2, knap4.getHeight() / 2);
      skalaanim.setDuration(300);
      skalaanim.setRepeatCount(1); // skalér ind og ud igen
      skalaanim.setRepeatMode(Animation.REVERSE);
      skalaanim.setInterpolator(new DecelerateInterpolator());
      knap4.startAnimation(skalaanim);

      AnimationSet sæt = new AnimationSet(false);
      sæt.addAnimation(skalaanim);
      sæt.addAnimation(translationsanim);
      sæt.addAnimation(alfaanim);
      knap5.startAnimation(sæt);
      sæt.setAnimationListener(new AnimationListener() {
        public void onAnimationStart(Animation animation) {
          knap1.setText("onAnimationStart(\n" + animation);
        }

        public void onAnimationEnd(Animation animation) {
          knap1.setText("onAnimationEnd(\n" + animation);
        }

        public void onAnimationRepeat(Animation animation) {
          knap1.setText("onAnimationRepeat(\n" + animation);
        }
      });
    } else if (klikPåHvad == knap5) {
      startActivity(new Intent(this, Braetspil.class));
      overridePendingTransition(R.anim.egen_anim, android.R.anim.fade_out);
    } else if (klikPåHvad == knap6) {

      int[] animationer = {R.anim.egen_anim, R.anim.hyperspace_out,
              R.anim.push_left_in, R.anim.push_left_out, R.anim.push_up_in, R.anim.push_up_out,
              R.anim.vende1, R.anim.vende2,
      };
      int animResId = animationer[animIndeks++ % animationer.length];
      String navn = getResources().getResourceEntryName(animResId);
      knap6.setText("Viser " + navn);
      knap6.startAnimation(AnimationUtils.loadAnimation(this, animResId));
    } else if (klikPåHvad == knap7) {
      //Animation settet bruges til at samle flere former for animationer (scale,rotate,translate)
      AnimationSet animationSet = new AnimationSet(true);

      TranslateAnimation t = new TranslateAnimation(0, 0, 0, 200);
      t.setDuration(500);
      t.setFillAfter(true);
      t.setRepeatCount(-1);
      t.setRepeatMode(TranslateAnimation.REVERSE);
      animationSet.addAnimation(t);

      RotateAnimation r = new RotateAnimation(0f, 15f, 0, 0);
      //r.setStartOffset(1000);
      r.setDuration(300);
      r.setRepeatCount(-1);
      r.setRepeatMode(RotateAnimation.REVERSE);
      animationSet.addAnimation(r);
      knap1.startAnimation(animationSet);
    }
  }

  // Kaldes når vi vender tilbage til denne aktivitet
  @Override
  protected void onRestart() {
    super.onRestart();
    // Når der vendes tilbage til denne aktivitet skal den gamle aktivitet
    // fades ud og denne aktivitet flyve ind med animationen i res/anim/egen_anim.xml
    overridePendingTransition(R.anim.hyperspace_out, android.R.anim.slide_out_right);
  }
}
